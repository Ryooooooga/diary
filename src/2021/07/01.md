『コンピュータシステムの理論と実装』を読んでいる。現在は7章の辺り。

この本は通称Nand2Tetrisと呼ばれている (らしい)。
その名の通りNANDゲートから(仮想的な)コンピュータを構築し、OS上でテトリスを実行するまでの過程を学ぶ。

1〜5章ではHDLを書いて論理回路、レジスタをはじめとする順序回路、ALU、CPU、それらを組み合わせたコンピュータを構成する。
6章ではそのコンピュータシステムのためのアセンブラを書く。

アセンブラを書くための言語はどのようなものを選択してもよいのだが、今回はRustを使って書いた。
RustはAlmelを書いたとき以来なのでかれこれ2年以上書いていなかったらしい。
構文からなにからすべてを忘れてしまっており、我ながら驚いた。

ところでアセンブラなんてものは適当にさっさと書き上げたかったのだが、それならばD言語やRubyやJSなどの適当に書ける言語を選択したほうが良かった。
Rustは適当に書くにはあまり向いていない。

結局、字句解析なんぞちんたら書きたくなかったので大きな正規表現1つで雑に1行ごとに処理するようにした。
9章以降では高水準言語のコンパイラを書かねばならないが、Rustを選択するべきか、少し悩んでいる。
